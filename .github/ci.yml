# GitHub Actions CI workflow
name: CI

on:
	pull_request:
		branches:
			- main
		types: [opened, synchronize, reopened]
		paths-ignore:
			- '**.md'
	push:
		branches:
			- main
		paths-ignore:
			- '**.md'
	workflow_dispatch:

jobs:
	build:
		if: >-
			(github.event_name == 'pull_request' && github.base_ref == 'main' && github.head_ref == 'develop') ||
			(github.event_name == 'push' && github.ref == 'refs/heads/main')
		runs-on: ubuntu-latest
		steps:
			- uses: actions/checkout@v4
			- name: Set up Node.js
				uses: actions/setup-node@v4
				with:
					node-version: '20'
			- name: Install dependencies
				run: npm ci
			- name: Lint
				run: npm run lint
			- name: Build
				run: npm run build
			- name: Test
				run: npm test -- --watchAll=false
